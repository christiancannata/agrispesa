"use strict";(globalThis.webpackChunkgoogle_listings_and_ads=globalThis.webpackChunkgoogle_listings_and_ads||[]).push([[528],{521:(e,t,a)=>{a.d(t,{A:()=>d});var r=a(7143),s=a(6520),o=a(7692),n=a(2775);const l="products",i={products:[],intervals:[],totals:{}};function d(e){const t=(0,n.A)();return(0,r.useSelect)(a=>{const{getReport:r}=a(s.Ui),n=r(l,e,t,"primary"),d=r(l,e,t,"secondary"),c=n.loaded&&d.loaded;let g=i;return c&&n.data&&d.data&&(g={products:n.data.products||i.products,intervals:n.data.intervals||i.intervals,totals:(0,o.bM)(n.data.totals,d.data.totals,n.reportQuery.fields)}),{data:g,loaded:c}},[e,t])}},6831:(e,t,a)=>{a.r(t),a.d(t,{default:()=>Qe});var r=a(7723),s=a(6087),o=a(6476),n=a(7143),l=a(6520),i=a(7692);function d(e=""){return[...new Set(e.split(",").map(e=>parseInt(e,10)).filter(e=>!isNaN(e)))]}function c(e,t={},a={}){return e.reduce((e,r)=>(e[r]=(t[r]||0)+(a[r]||0),e),{})}function g(e,t){if(!t)return e||null;if(!e)return t;const a=new Map(e.map(e=>[e.interval,e.subtotals])),r=new Map(t.map(e=>[e.interval,e.subtotals]));return[...new Set([...a.keys(),...r.keys()])].sort().map(e=>({interval:e,subtotals:c(i.YK,a.get(e),r.get(e))}))}function p(e,t={},a){const r=e?Object.keys(e):a;return e=e||{},r.reduce((r,s)=>{let o=i.XQ.NONE,n=e[s];return a&&(a.includes(s)?void 0===t[s]?o=i.XQ.FOR_REQUEST:n=(e[s]||0)+t[s]:o=i.XQ.FOR_METRIC),{...r,[s]:(0,i.jr)(n,void 0,o)}},{})}var u=a(2775),m=a(3905);const _="programs",y={free_listings:[],campaigns:[],intervals:[],totals:{}},h={loaded:!0,data:{},reportQuery:null};function f(e,t,a){const r=d(t[m.s_]),s=0===r.length||r.includes(m.Q),o=(0===r.length||r.some(e=>e!==m.Q))&&m.Th.adsSetupComplete;return{free:s&&e(_,"free",t,a)||h,paid:o&&e(_,"paid",t,a)||h}}var b=a(3772),v=a(7419);const k=(0,r.__)("Unavailable","google-listings-and-ads");function x(e){const{formatNumber:t}=(0,b.A)(),{formatAmount:a}=(0,v.A)();return(0,s.useMemo)(()=>{function r(e){return void 0===e?k:this.isCurrency?a(e,!0):t(e,0)}return e.map(e=>({...e,formatFn:r}))},[e,t,a])}var S=a(2047),C=a(9927),j=a(8468),A=a(7374),P=a(5703);const F=[{id:m.Q,name:(0,r.__)("Product Feed","google-listings-and-ads")}],M=new Set(F.map(e=>e.id));var w=a(1209),L=a(2448),T=a(6473),Q=a(4848);const E=(0,P.getSetting)("locale").siteLocale,N=(()=>{let e,t,a;function s(){e=null,a=new Promise(e=>{t=e}).then(()=>F.concat(e))}s();const o={name:"programs",options:()=>a,getOptionIdentifier:e=>e.id,getOptionLabel:e=>e.name,getOptionKeywords:e=>[e.name],getOptionCompletion:e=>({key:e.id,label:e.name})};async function n(e){const t=new Set(d(e));let r;return r=function(e,t){if(e.size>t.size)return!1;for(const a of e)if(!t.has(a))return!1;return!0}(t,M)?F:(await a).filter(e=>t.has(e.id)),r.map(e=>({key:e.id,label:e.name}))}const l={label:(0,r.__)("Show","google-listings-and-ads"),staticParams:["period","chartType","paged","per_page","selectedMetric","reportKey","orderby","order"],param:"filter",showFilters:()=>!0,filters:[{label:(0,r.__)("All Google programs","google-listings-and-ads"),value:"all"},{label:(0,r.__)("Single program","google-listings-and-ads"),value:"select_program",subFilters:[{component:"Search",value:"single_program",path:["select_program"],settings:{type:"custom",param:m.s_,getLabels:n,labels:{placeholder:(0,r.__)("Type to search for a program","google-listings-and-ads"),button:(0,r.__)("Single Program","google-listings-and-ads")},autocompleter:o}}]},{label:(0,r.__)("Comparison","google-listings-and-ads"),chartMode:"item-comparison",value:"compare-programs",settings:{type:"custom",param:m.s_,getLabels:n,labels:{helpText:(0,r.__)("Check at least two programs below to compare","google-listings-and-ads"),placeholder:(0,r.__)("Search for programs to compare","google-listings-and-ads"),title:(0,r.__)("Compare Programs","google-listings-and-ads"),update:(0,r.__)("Compare","google-listings-and-ads")},autocompleter:o}}]};return({data:a,loaded:r})=>(r?(e&&e!==a&&s(),e=a,t()):e&&s(),l)})(),I=e=>{const{query:t,trackEventId:a}=e,r=[N((0,w.A)({exclude_removed:!1}))],{period:s,compare:o,before:n,after:l}=(0,A.getDateParamsFromQuery)(t),{primary:i,secondary:d}=(0,A.getCurrentDates)(t),c={period:s,compare:o,before:n,after:l,primaryDate:i,secondaryDate:d},g=(0,b.A)(),p={...t};return(0,Q.jsx)(L.A,{query:p,siteLocale:E,currency:g,filters:r,onDateSelect:e=>(0,T.ce)("gla_datepicker_update",{report:a,...(0,j.omitBy)(e,j.isUndefined)}),onFilterSelect:e=>(0,T.ce)("gla_filter",{report:a,filter:e.filter||"all"}),path:t.path,dateQuery:c,isoDateFormat:A.isoDateFormat})};var D=a(8846),O=a(4275),R=a(9039),q=a(2848);const V="https://merchants.google.com/mc/reporting/dashboard",B=({href:e,selected:t,onLinkClickCallback:a,metric:o,data:{value:n,prevValue:l,delta:d,missingFreeListingsData:c}})=>{const g=(0,s.useMemo)(()=>({value:o.formatFn(n),prevValue:o.formatFn(l)}),[o,n,l]);let p=o.label;const u=[],m=[];if(c!==i.XQ.NONE){const e=(0,r.__)("This data is currently available for Google Ads campaigns only.","google-listings-and-ads");u.push(e),m.push(e)}if(c===i.XQ.FOR_REQUEST){const e=(0,r.__)("Please try again later, or go to <googleMerchantCenterLink /> to track your performance for Google Product Feed.","google-listings-and-ads");u.push((0,s.createInterpolateElement)(e,{googleMerchantCenterLink:(0,Q.jsx)(q.A,{eventName:"gla_google_mc_link_click",eventProps:{context:"reports",href:V},type:"external",target:"_blank",href:V,onClick:e=>e.stopPropagation(),children:(0,r.__)("Google Merchant Center","google-listings-and-ads")})}));const t=(0,s.createInterpolateElement)(e,{googleMerchantCenterLink:(0,Q.jsx)(Q.Fragment,{children:(0,r.sprintf)(
// translators: %s: link to Google Merchant Center.
// translators: %s: link to Google Merchant Center.
(0,r.__)("Google Merchant Center (%s)","google-listings-and-ads"),V)})});m.push((0,s.renderToString)(t))}if(u.length>0){const e=u.map((e,t)=>(0,Q.jsx)("div",{className:"gla-reports__metric-info",children:e},t));p=(0,Q.jsxs)("div",{className:"gla-reports__metric-label",children:[o.label,(0,Q.jsx)(R.A,{text:e,children:(0,Q.jsx)(O.A,{className:"gla-reports__metric-infoicon",role:"img","aria-label":m.join(" "),size:16})})]})}return(0,Q.jsx)(D.SummaryNumber,{label:p,href:e,selected:t,delta:d,onLinkClickCallback:a,...g})},K={value:null,preValue:null,delta:null},U=({loaded:e,metrics:t,expectedLength:a=t.length,totals:r,trackEventId:s})=>{const n=(0,u.A)();if(!e)return(0,Q.jsx)(D.SummaryListPlaceholder,{numberOfItems:a});const{selectedMetric:l=t[0].key}=n;return(0,Q.jsx)(D.SummaryList,{children:()=>t.map(e=>{const{key:t}=e,a=l===t,n=(0,o.getNewPath)({selectedMetric:t});return(0,Q.jsx)(B,{metric:e,href:n,selected:a,data:r[t]||K,onLinkClickCallback:()=>{return e=t,void(0,T.ce)("gla_chart_tab_click",{report:s,context:e});var e}},t)})})},G=(0,r.__)("No data for the selected date range","google-listings-and-ads");function z({metrics:e,loaded:t,intervals:a}){const r=(0,u.A)(),o=(0,b.A)(),{selectedMetric:n}=r;let l={};e.length&&(l=n&&e.find(e=>e.key===n)||e[0]);const{key:i,label:d,isCurrency:c=!1,formatFn:g}=l,p={...o,symbol:""},m=(0,A.getChartTypeForQuery)(r),_=c?"currency":"number",y=g.bind(l),h=(0,s.useMemo)(()=>t?a.map(({interval:e,subtotals:t})=>({date:e,[d]:{value:t[i],label:d}})):[],[i,d,t,a]);return(0,Q.jsx)(D.Chart,{data:h,title:d,query:r,currency:p,chartType:m,valueType:_,tooltipValueFormat:y,isRequesting:!t,emptyMessage:G,layout:"time-comparison",legendPosition:"hidden"})}var X=a(6427),H=a(7892),Y=a(8237);const $=({compareBy:e,compareParam:t,metrics:a,isLoading:n,compareButtonTitle:l,data:i,nameHeader:c,nameCell:g,...p})=>{const m=(0,u.A)(),[_,y]=(0,s.useState)(()=>new Set(d(m[e]))),h=i.length||5,f=(0,s.useMemo)(()=>{if(!a.length)return[];const e=a.map(e=>({...e,isSortable:!0,isNumeric:!0}));return e[0].defaultSort=!0,e[0].defaultOrder="desc",e},[a]),b=e=>a.map(t=>{const a=e.subtotals[t.key];return{display:t.formatFn(a)}}),v=(e,t)=>{t?y(new Set([..._,e])):(_.delete(e),y(new Set(_)))};return(0,Q.jsx)(Y.A,{actions:(0,Q.jsx)(H.A,{isSecondary:!0,disabled:n||_.size<=1,title:l,onClick:()=>{const a=Array.from(_).join(",");(0,o.onQueryChange)("compare")(e,t,a)},children:(0,r.__)("Compare","google-listings-and-ads")}),isLoading:n,headers:(k=i,[{key:"compare",label:(0,Q.jsx)(X.CheckboxControl,{disabled:n,checked:!n&&k.length&&_.size===k.length,onChange:e=>{if(e){const e=i.map(e=>e.id);y(new Set(e))}else y(new Set)}}),required:!0},{key:"title",label:c,isLeftAligned:!0,required:!0},...f]),rows:(e=>e.map(e=>[{display:(0,Q.jsx)(X.CheckboxControl,{checked:_.has(e.id),onChange:v.bind(null,e.id)})},{display:g(e)},...b(e)]))(i),totalRows:i.length,rowsPerPage:h,query:m,compareBy:e,compareParam:t,onQueryChange:o.onQueryChange,onSort:(0,o.onQueryChange)("sort"),...p});var k},J=({isConverted:e,name:t})=>e?(0,Q.jsx)("div",{className:"gla-reports__tooltip-campaign-name",children:(0,Q.jsx)(R.A,{placement:"top-start",text:(0,r.__)("This campaign has been upgraded to Performance Max","google-listings-and-ads"),children:t})}):t,W=({isLoading:e,orderby:t,order:a,metrics:o,freeListings:n,campaigns:l,...i})=>{const d=(0,s.useMemo)(()=>{if(e)return[];if(!n||0===n.length)return l;const s=[{...n[0],name:(0,r.__)("Product Feed","google-listings-and-ads"),id:m.Q},...l];return l.length&&(s.sort((e,a)=>(e.subtotals[t]||Number.NEGATIVE_INFINITY)-(a.subtotals[t]||Number.NEGATIVE_INFINITY)),"desc"===a&&s.reverse()),s},[e,n,l,t,a]);return(0,Q.jsx)($,{title:(0,r.__)("Programs","google-listings-and-ads"),compareButtonTitle:(0,r.__)("Select one or more programs to compare","google-listings-and-ads"),nameHeader:(0,r.__)("Program","google-listings-and-ads"),nameCell:J,compareBy:"programs",compareParam:"filter",metrics:o,isLoading:e,data:d,...i})};var Z=a(1670),ee=a(9269);const te=[{key:"programs",title:(0,r.__)("Programs","google-listings-and-ads"),href:(0,o.getNewPath)({reportKey:"programs"},"/google/reports",{})},{key:"products",title:(0,r.__)("Products","google-listings-and-ads"),href:(0,o.getNewPath)({reportKey:"products"},"/google/reports",{})}],ae=()=>{const e=(0,ee.A)();return(0,Q.jsx)(Z.A,{tabs:te,selectedKey:e})};var re=a(5246);const se=[{key:"sales",label:(0,r.__)("Total Sales","google-listings-and-ads"),isCurrency:!0},{key:"conversions",label:(0,r.__)("Conversions","google-listings-and-ads")},{key:"clicks",label:(0,r.__)("Clicks","google-listings-and-ads")},{key:"impressions",label:(0,r.__)("Impressions","google-listings-and-ads")}],oe=[...se,{key:"spend",label:(0,r.__)("Total Spend","google-listings-and-ads"),isCurrency:!0}],ne=[...se,{key:"spend",label:(0,r.__)("Spend","google-listings-and-ads"),isCurrency:!0}],le=()=>{const e="reports-programs",{loaded:t,data:{totals:a,intervals:r,freeListings:d,campaigns:c},reportQuery:{fields:m,orderby:_,order:h}}=function(){const e=(0,u.A)(),{paid:t,free:a}=(0,n.useSelect)(t=>{const{getReport:a}=t(l.Ui);return f(a,e,"primary")},[e]),r=t.loaded&&a.loaded,o=t.reportQuery||a.reportQuery,i=a.reportQuery?.fields,d=(0,s.useMemo)(()=>{const e=a.data,s=t.data;return r&&s&&e?{freeListings:e.free_listings||y.free_listings,campaigns:s.campaigns||y.campaigns,intervals:g(s.intervals,e.intervals)||y.intervals,totals:p(s.totals,e.totals,i)}:y},[r,t.data,a.data,i]);return{loaded:r,reportQuery:o,data:d}}(),b=(0,s.useMemo)(()=>{const e=t&&Object.keys(a).length>0;return{available:e?oe.filter(({key:e})=>a.hasOwnProperty(e)):oe.filter(({key:e})=>m.includes(e)),expected:e?ne.filter(({key:e})=>a.hasOwnProperty(e)):ne.filter(({key:e})=>m.includes(e))}},[t,a,m]),v=x(b.available),k=x(b.expected),{loaded:j,data:A}=function(e){const t=(0,u.A)(),{loaded:a,data:r}=function(e){const{paid:t,free:a}=(0,n.useSelect)(t=>{const{getReport:a}=t(l.Ui);return f(a,e,"secondary")},[e]),r=t.loaded&&a.loaded,o=a.reportQuery?.fields,i=(0,s.useMemo)(()=>{const e=a.data,s=t.data;return r&&s&&e?p(s.totals,e.totals,o):y.totals},[r,t.data,a.data,o]);return{loaded:r,data:i}}(t),o=(0,s.useMemo)(()=>a?function(e,t){return Object.keys(e).reduce((a,r)=>({...a,[r]:(0,i.jr)(e[r].value,t[r]?.value,e[r].missingFreeListingsData)}),{})}(e,r):e,[a,r,e]);return{loaded:a,data:o}}(a),P=j?A:a;return(0,Q.jsxs)(Q.Fragment,{children:[(0,Q.jsx)(S.A,{context:e}),(0,Q.jsx)(C.A,{}),(0,Q.jsx)(re.A,{}),(0,Q.jsx)(ae,{}),(0,Q.jsx)(I,{query:(0,o.getQuery)(),trackEventId:e}),(0,Q.jsx)(U,{loaded:t,metrics:v,expectedLength:oe.length,totals:P,trackEventId:e}),(0,Q.jsx)(z,{metrics:v,loaded:t,intervals:r}),(0,Q.jsx)(W,{trackEventReportId:e,isLoading:!t,orderby:_,order:h,metrics:k,freeListings:d,campaigns:c})]})};var ie=a(521),de=a(3741),ce=a(314),ge=a(2619),pe=a(3832),ue=a(1455),me=a.n(ue);function _e(e,t=j.identity){return function(a="",r){const s="function"==typeof e?e(r):e,n=(0,o.getIdsFromQuery)(a);if(n.length<1)return Promise.resolve([]);const l={include:n.join(","),per_page:n.length};return me()({path:(0,pe.addQueryArgs)(s,l)}).then(e=>e.map(t))}}const ye=_e(ce.NAMESPACE+"/products",e=>({key:e.id,label:e.name,type:e.type}));function he({attributes:e,name:t}){const a=(0,P.getSetting)("admin")?.variationTitleAttributesSeparator||" - ";if(t.indexOf(a)>-1)return t;const r=e.map(({option:e})=>e).join(", ");return r?t+a+r:t}const fe=_e(({products:e})=>e?ce.NAMESPACE+`/products/${e}/variations`:ce.NAMESPACE+"/variations",e=>({key:e.id,label:he(e)})),be={label:(0,r.__)("Show","google-listings-and-ads"),staticParams:[m.DA,"chartType","orderby","order","paged","per_page","selectedMetric","reportKey"],param:"filter",showFilters:()=>!0,filters:[{label:(0,r.__)("All Products","google-listings-and-ads"),value:"all"},{label:(0,r.__)("Single Product","google-listings-and-ads"),value:"select_product",chartMode:"item-comparison",subFilters:[{component:"Search",value:"single-product",chartMode:"item-comparison",path:["select_product"],settings:{type:"products",param:"products",getLabels:ye,labels:{placeholder:(0,r.__)("Type to search for a product","google-listings-and-ads"),button:(0,r.__)("Single Product","google-listings-and-ads")}}}]},{label:(0,r.__)("Comparison","google-listings-and-ads"),value:"compare-products",chartMode:"item-comparison",settings:{type:"products",param:"products",getLabels:ye,labels:{helpText:(0,r.__)("Check at least two products below to compare","google-listings-and-ads"),placeholder:(0,r.__)("Search for products to compare","google-listings-and-ads"),title:(0,r.__)("Compare Products","google-listings-and-ads"),update:(0,r.__)("Compare","google-listings-and-ads")}}}]},ve={showFilters:e=>"single-product"===e.filter&&!!e.products&&e["is-variable"],staticParams:["filter","products","chartType","orderby","order","paged","per_page","selectedMetric","reportKey"],param:"filter-variations",filters:[{label:(0,r.__)("All Variations","google-listings-and-ads"),chartMode:"item-comparison",value:"all"},{label:(0,r.__)("Single Variation","google-listings-and-ads"),value:"select_variation",subFilters:[{component:"Search",value:"single-variation",path:["select_variation"],settings:{type:"variations",param:"variations",getLabels:fe,labels:{placeholder:(0,r.__)("Type to search for a variation","google-listings-and-ads"),button:(0,r.__)("Single Variation","google-listings-and-ads")}}}]},{label:(0,r.__)("Comparison","google-listings-and-ads"),chartMode:"item-comparison",value:"compare-variations",settings:{type:"variations",param:"variations",getLabels:fe,labels:{helpText:(0,r.__)("Check at least two variations below to compare","google-listings-and-ads"),placeholder:(0,r.__)("Search for variations to compare","google-listings-and-ads"),title:(0,r.__)("Compare Variations","google-listings-and-ads"),update:(0,r.__)("Compare","google-listings-and-ads")}}}]},ke={label:(0,r.__)("Show data from","google-listings-and-ads"),param:m.DA,staticParams:["filter","products","orderby","order","chartType","selectedMetric","reportKey"],defaultValue:m.r6,filters:[{value:m.Mx,label:(0,r.__)("Ad campaigns","google-listings-and-ads")},{value:m.k1,label:(0,r.__)("Product feed","google-listings-and-ads")}],showFilters:({hasPaidSource:e})=>e},xe=(0,ge.applyFilters)("gla_products_report_filters",[be,ve,ke]),Se=(0,ge.applyFilters)("gla_products_report_advanced_filters",{}),Ce=(0,P.getSetting)("currency"),je=(0,P.getSetting)("locale").siteLocale,Ae=e=>{const{hasPaidSource:t,query:a,trackEventId:r}=e,{period:s,compare:o,before:l,after:i}=(0,A.getDateParamsFromQuery)(a),{primary:d,secondary:c}=(0,A.getCurrentDates)(a),g={period:s,compare:o,before:l,after:i,primaryDate:d,secondaryDate:c},p=(0,n.useSelect)(e=>{if(a.search||!a.products||1!==a.products.split(",").length)return!1;const t=parseInt(a.products,10),r={include:t},{getItems:s}=e(ce.ITEMS_STORE_NAME),o=s("products",r);return o&&o.get(t)&&"variable"===o.get(t).type},[a.search,a.products]),u={...a,"is-variable":p,hasPaidSource:t};return(0,Q.jsx)(D.ReportFilters,{query:u,siteLocale:je,currency:Ce,filters:xe,advancedFilters:Se,onDateSelect:e=>(0,T.ce)("gla_datepicker_update",{report:r,...(0,j.omitBy)(e,j.isUndefined)}),onFilterSelect:e=>(0,T.ce)("gla_filter",{report:r,filter:e.filter||"all",filter_variation:e["filter-variations"]}),dateQuery:g,isoDateFormat:A.isoDateFormat})},Pe=({metrics:e,isLoading:t,products:a,...s})=>(0,Q.jsx)($,{title:(0,r.__)("Products","google-listings-and-ads"),compareButtonTitle:(0,r.__)("Select one or more products to compare","google-listings-and-ads"),nameHeader:(0,r.__)("Product title","google-listings-and-ads"),nameCell:e=>e.name,compareBy:"products",compareParam:"filter",metrics:e,isLoading:t,data:a,...s}),Fe=[{key:"clicks",label:(0,r.__)("Clicks","google-listings-and-ads")},{key:"impressions",label:(0,r.__)("Impressions","google-listings-and-ads")}],Me=[{key:"sales",label:(0,r.__)("Total Sales","google-listings-and-ads"),isCurrency:!0},{key:"conversions",label:(0,r.__)("Conversions","google-listings-and-ads")},...Fe,{key:"spend",label:(0,r.__)("Spend","google-listings-and-ads"),isCurrency:!0}],we=({hasPaidSource:e})=>{const t="reports-products",a=(0,o.getQuery)(),r=e?a[m.DA]||m.r6:m.k1,s=x(r===m.Mx?Me:Fe),{loaded:n,data:{totals:l,intervals:i,products:d}}=(0,ie.A)(r);return(0,Q.jsxs)(Q.Fragment,{children:[(0,Q.jsx)(Ae,{hasPaidSource:e,query:a,trackEventId:t}),(0,Q.jsx)(U,{metrics:s,loaded:n,totals:l,trackEventId:t}),(0,Q.jsx)(z,{metrics:s,loaded:n,intervals:i}),(0,Q.jsx)(Pe,{trackEventReportId:t,metrics:s,isLoading:!n,products:d})]})},Le=()=>{const{loaded:e,data:t}=(0,w.A)(),a=e&&t.some(({status:e})=>"enabled"===e);return(0,Q.jsxs)(Q.Fragment,{children:[(0,Q.jsx)(S.A,{context:"reports-products"}),(0,Q.jsx)(C.A,{}),(0,Q.jsx)(re.A,{}),(0,Q.jsx)(ae,{}),e?(0,Q.jsx)(we,{hasPaidSource:a}):(0,Q.jsx)(de.A,{})]})};var Te=a(2635);const Qe=()=>{const e=(0,ee.A)();return(0,Q.jsxs)(Q.Fragment,{children:[(0,Q.jsx)(Te.A,{}),"products"===e?(0,Q.jsx)(Le,{}):(0,Q.jsx)(le,{})]})}}}]);